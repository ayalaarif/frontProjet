<!--== BODY INNER CONTAINER ==-->

<div style="height:100%" class="sb2-2">
    <!--== breadcrumbs ==-->
    <div class="sb2-2-2">
        <ul>
            <li><a routerLink="/"><i class="fa fa-home" aria-hidden="true"></i> Accueil</a>
            </li>
            <li class="active-bre"><a> Marquer Absences</a>
            </li>

        </ul>
    </div>

    <!--== User Details ==-->
    <div class="sb2-2-3">
        <div class="row">
            <div class="col-md-12">
                <div class="box-inn-sp admin-form">
                    <div class="inn-title">
                        <h4>Liste des Absences</h4>
                    </div>
                    <div class="tab-inn">
                        <form #absenceForm="ngForm">
                            <div class="row"*ngIf="deleteMsg">
                                <div class="input-field col s12">
                                    <p class="alert alert-success">
                                        <strong>Suppression avec succès</strong>
                                    </p>
                                </div>
                            </div>
                            <div class="row"*ngIf="updateMsg">
                                <div class="input-field col s12">
                                    <p class="alert alert-success">
                                        <strong>Modification avec succès</strong>
                                    </p>
                                </div>
                            </div>
                            <div class="row" *ngIf="errorMsg">
                            <div class="input-field col s12">
                                <p class="alert alert-danger">
                                    <strong>Veuillez vérifier vos champs</strong>
                                </p>
                            </div>
                        </div>

                            <!-- <div class="row"
                                *ngIf="MsgError== true && myBtnIdClicked== true">
                                <div class="input-field col s12">
                                    <p class="alert alert-danger">
                                        <strong>Veuillez vérifier vos champs</strong>
                                    </p>
                                </div>
                            </div> -->

                            <div class="row" style="display: flex;">

                                <div class="input-field col s6">
                                    <label *ngIf="!box1.value" for="grp">Groupes</label>
                                    <select (change)="onSelect()" #box1="ngModel" id="grp" class="form-control"
                                        name="groupe_id" [(ngModel)]="data.groupe_id" required>
                                        <!-- <option disabled selected>Groupes</option> -->
                                        <option *ngFor="let groupe of groupes" [value]="groupe.id">
                                            {{groupe.niveau.libelle}} {{groupe.num}}</option>
                                    </select>
                                </div>


                                <div class="input-field col s6">
                                    <!-- <label *ngIf="!box2.value" for="seance">Seances</label> -->
                                    <select (change)="onSelect1()" #box2="ngModel" id="seance" class="form-control" name="seance_id" [(ngModel)]="data.seance_id" required>
                                        <option [value]="0" disabled selected>Seance</option>
                                        <option *ngFor="let s of seances" [value]="s.id"> {{s.jour}} {{s.heure | slice :0:5}}</option>
                                    </select>

                                </div>

                                <div class="input-field col s6">
                                    <!-- <label *ngIf="!box2.value" for="seance">Seances</label> -->
                                    <select (change)="onSelect2()" #box3="ngModel" id="date" class="form-control" name="date" [(ngModel)]="data.date" required>
                                        <option [value]="'vide'" disabled selected>Date</option>
                                        <option *ngFor="let d of dates" [value]="d.date">{{d.date}}</option>
                                    </select>

                                </div>

                            </div>
                            <ng-container *ngIf="l>0;else ElseIf">
                              
                                <div  class="table-responsive table-desi">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>#</th>
                                                <th>Matricule</th>
                                                <th>élève</th>
                                                <th>Statut</th>
                                                <ng-container *ngIf="update">
                                                    <th></th>
                                                </ng-container>
                                                <!-- <th>Justiffication</th> -->
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
    
                                            <tr *ngFor="let e of eleves; index as i">
                    
                                                
                                                 <ng-container *ngIf="this.index==i;else modAbsence">
                                                    <td>
                                                        <!-- <div style="padding-top:80%"> -->
                                                            {{i+1}}
                                                        <!-- </div> -->
                                                    </td>
                                                    <td>
                                                        <!-- <div style="padding-top:9%"> -->
                                                           {{e.eleve.matricule}}
                                                        <!-- </div> -->
                                                    </td>
    
                                                    <td>
                                                        <!-- <input type="number"  name="eleve_id" class="validate" [(ngModel)]="listNotes.notes[i].eleve_id"> -->
                                                        <!-- <div style="padding-top:9%"> -->
                                                           {{e.eleve.nom}} {{e.eleve.prenom}}
                                                        <!-- </div> --> 
                                                    </td>
                                                    <td *ngFor="let type of types; let j = index">
                                                        
                                                        <input #checkbox [ngModel]="type.selected"  class="filled-in"  name="{{type.id}}" type="checkbox"  id="filled-in-box-{{j}}"  (click)="selectCheckBox(checkbox.id,type.name)">
                                                        <label  for="filled-in-box-{{j}}">{{type.name}}</label>
                                                        <ng-container *ngIf="(type.id==2)&&(checkbox.checked)">
                                                       
                                                         <input style=" float:right; width: auto;"  type="text" name="margeRetard-{{i}}" placeholder="marge Retard" [(ngModel)]="eleveAbsence.margeRetard">
                                                            
                                                       </ng-container>
                                                        <!-- <ng-template #second>
                                                            <ng-container *ngIf="type.id==3">
                                                                <br>
                                                        <input type="text" name="justification-{{i}}" placeholder="Justification" [(ngModel)]="eleveAbsence.justification">
                                                      
                                                         </ng-container>
                                                         </ng-template> -->
                                                        <!-- </div> -->
    
                                                    </td>
                                                  
                                                    
                                                    <td> 
                                                        <div  >   
                                                            <a  (click)="modifierAbsence()" style="background-color: #58b392;margin-right: 10px;" class="label label-success">Valider</a>
                                                         
                                                            <a (click)="annuler()" style="background-color: #f44336" class="label label-success">Anuuler</a>
                                                        </div>
                                                    </td>
                                                </ng-container>
                                                <ng-template #modAbsence>
                                                    <td>
                                                        <!-- <div class="input-field col s6"> -->
                                                            {{i+1}}
                                                        <!-- </div> -->
                                                    </td>
                                                    <td>
                                                        <!-- <div class="input-field col s6"> -->
                                                            
                                                            {{e.eleve.matricule}}
                                                        <!-- </div> -->
                                                    </td>
    
                                                    <td>
                                                        <!-- <input type="number"  name="eleve_id" class="validate" [(ngModel)]="listNotes.notes[i].eleve_id"> -->
                                                        <!-- <div class="input-field col s12"> -->
                                                            
                                                            {{e.eleve.nom}} {{e.eleve.prenom}}
                                                        <!-- </div> -->
                                                    </td>
                                                    <td>
                                                        <!-- <span class="list-enq-name">Aerospace Engineering</span> -->
                                                      {{e.type}}<ng-container *ngIf="(e.type).toUpperCase()==='retard'.toUpperCase()"> de {{e.margeRetard}} </ng-container> 
                                                      
                                                    </td>
                                                   
                                                    <!-- <td>  <a  (click)="modifier(e.note[0],i)" style="background-color: #002147;margin-right: 10px;" class="label label-success">Modifier</a>
                                                        
                                                         
                                                        <a (click)="supprimerNote(e.note[0].id)" style="background-color: #f44336" class="label label-success">Supprimer</a></td>
                                                    </ng-template>   -->

                                                    <ng-container *ngIf="update">
                                                        <td></td>
                                                    </ng-container>
                                                <td>  <a (click)="modifier(e,i)" style="background-color: #002147;margin-right: 10px;" class="label label-success">Modifier</a>
                                                                
                                                                 
                                                    <a data-toggle="modal" data-target="#modal20" (click)="onClick(e.id)" style="background-color: #f44336" class="label label-success">Supprimer</a></td>
                                                </ng-template>
                                                 
                                            </tr>

                                             <!-- delete confirmation pop-up  -->
                                        <div id="modal20" class="modal fade" role="dialog">
                                            <div class="log-in-pop" style="width: 60%; height:40%; padding:5%">
                                                <a #closeModal href="#" class="pop-close" data-dismiss="modal"><img
                                                        src="assets/images/cancel.png" alt="" />
                                                </a>
                                                <h2 style="text-align: center; color: rgba(0, 0, 0, 0.934);">
                                                    Supprimer Absence
                                                </h2>
                                                <h4 style="color: rgba(3, 3, 3, 0.873);">Êtes-vous sûr de vouloir
                                                    supprimer cette absence ?
                                                </h4> <br>


                                                <div
                                                    style="display: grid; grid-template-columns: auto auto; grid-gap: 50px;">
                                                    <input (click)="cancel()" type="submit" value="Annuler"
                                                        class="waves-effect waves-light log-in-btn"
                                                        style="background-color: #002147;">
                                                    <input (click)="supprimerAbsence(idAbsence)" type="submit"
                                                        value="Supprimer" class="waves-effect waves-light log-in-btn">

                                                </div>

                                            </div>
                                        </div>
    
                                        </tbody>
                                    </table>
                                </div>
                               
                            </ng-container>
                            <ng-template #ElseIf>
                                <ng-container *ngIf="select">
                                    <div class="row">
                                        <div class="input-field col s12">
                                        <h4 style="padding:1%"> Aucune absence n'a été ajoutée pour le moment...</h4>
                                        </div>
                                    </div>
                                </ng-container>
                               
                              
                              </ng-template>
                            
                           
                          

                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
